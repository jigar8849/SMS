<%- layout("layouts/boilerplate") %>

<style>
    .main-card {
        width: 23rem !important;
    }

    /* Default styles for desktop */
    .vehicle-container {
        padding: 1rem;
    }

    /* Large Desktop Screens */
    @media screen and (min-width: 1400px) {
        .main-card {
            width: 25rem !important;
        }
        .vehicle-container {
            padding: 2rem;
        }
        .card {
            padding: 1.5rem !important;
        }
        .fs-1 {
            font-size: 3rem !important;
        }
    }

    /* Desktop */
    @media screen and (max-width: 1199px) {
        .main-card {
            width: 21rem !important;
        }
        .vehicle-container {
            padding: 1.5rem;
        }
    }

    /* Large Tablets (iPad Pro) */
    @media screen and (max-width: 1024px) {
        .main-card {
            width: 18rem !important;
        }
        .vehicle-container {
            padding: 1rem;
        }
        .com-header h2 {
            font-size: 1.6rem;
        }
        .card {
            padding: 1rem !important;
        }
        .fs-1 {
            font-size: 2.5rem !important;
        }
        .col-md-4 {
            margin-bottom: 1rem;
        }
    }

    /* Standard Tablets (iPad) */
    @media screen and (max-width: 768px) {
        .main-card {
            width: 100% !important;
            max-width: 100%;
        }
        
        .vehicle-container {
            padding: 0.8rem;
        }

        .com-header {
            flex-direction: column;
            text-align: center;
            margin-bottom: 1rem;
        }

        .com-header h2 {
            font-size: 1.4rem;
            margin-bottom: 0.5rem;
        }

        .com-header p {
            font-size: 0.9rem;
        }

        /* Statistics cards */
        .row.g-3 .card {
            padding: 0.8rem !important;
            margin-bottom: 0.5rem;
        }

        .row.g-3 .card h3 {
            font-size: 1.5rem;
        }

        .row.g-3 .card .fs-2 {
            font-size: 1.8rem !important;
        }

        /* Search section */
        .col-md-9, .col-md-3 {
            margin-bottom: 0.8rem;
        }

        .input-group {
            margin-bottom: 0.5rem;
        }

        /* Vehicle cards */
        .col-md-4 {
            flex: 0 0 100%;
            max-width: 100%;
        }

        .vehicleCard .card {
            padding: 1rem !important;
        }

        .fs-1 {
            font-size: 2rem !important;
        }

        .vehicleCard h4 {
            font-size: 1.1rem;
        }

        .fs-5 {
            font-size: 0.9rem !important;
        }

        .d-flex.gap-3 {
            gap: 0.5rem !important;
        }
    }

    /* Small Tablets and Large Phones */
    @media screen and (max-width: 600px) {
        .vehicle-container {
            padding: 0.5rem;
        }

        .com-header h2 {
            font-size: 1.2rem;
        }

        .com-header p {
            font-size: 0.8rem;
        }

        /* Statistics cards - stack vertically */
        .row.g-3 .card {
            padding: 0.6rem !important;
            flex-direction: column;
            text-align: center;
        }

        .row.g-3 .card h6 {
            font-size: 0.8rem;
        }

        .row.g-3 .card h3 {
            font-size: 1.3rem;
            margin-top: 0.3rem;
        }

        .row.g-3 .card .fs-2 {
            font-size: 1.5rem !important;
            margin-top: 0.5rem;
        }

        /* Search section */
        .border.rounded.p-3 {
            padding: 0.8rem !important;
        }

        .form-control, .form-select {
            font-size: 0.9rem;
            padding: 0.5rem;
        }

        /* Vehicle cards */
        .vehicleCard .card {
            padding: 0.8rem !important;
        }

        .vehicleCard .row.align-items-center {
            flex-direction: column;
            text-align: center;
        }

        .fs-1 {
            font-size: 1.8rem !important;
        }

        .vehicleCard h4 {
            font-size: 1rem;
            margin-top: 0.5rem;
        }

        .badge {
            font-size: 0.7rem;
        }

        .fs-5 {
            font-size: 0.8rem !important;
            line-height: 1.4;
        }

        .btn {
            font-size: 0.8rem;
            padding: 0.4rem 0.8rem;
        }
    }

    /* Standard Mobile Phones */
    @media screen and (max-width: 480px) {
        .vehicle-container {
            padding: 0.3rem;
        }

        .owner-list-container {
            padding: 0.3rem;
        }

        .event-container {
            padding: 0.5rem;
        }

        .com-header h2 {
            font-size: 1.1rem;
        }

        .com-header p {
            font-size: 0.75rem;
        }

        /* Statistics cards */
        .mt-4 {
            margin-top: 1rem !important;
        }

        .row.g-3 {
            gap: 0.5rem !important;
        }

        .row.g-3 .card {
            padding: 0.5rem !important;
            margin-bottom: 0.3rem;
        }

        .row.g-3 .card h6 {
            font-size: 0.7rem;
            margin-bottom: 0.2rem;
        }

        .row.g-3 .card h3 {
            font-size: 1.1rem;
        }

        .row.g-3 .card .fs-2 {
            font-size: 1.3rem !important;
        }

        /* Search section */
        .border.rounded.p-3 {
            padding: 0.6rem !important;
            margin: 0.5rem 0;
        }

        .input-group-text {
            padding: 0.4rem 0.6rem;
        }

        .form-control, .form-select {
            font-size: 0.8rem;
            padding: 0.4rem;
        }

        /* Vehicle info section */
        .vehicle-info {
            margin: 0.5rem 0 !important;
        }

        .info-head {
            margin: 0.8rem !important;
        }

        .info-head h5 {
            font-size: 1rem;
        }

        /* Vehicle cards */
        .container.mb-3.mt-4 {
            padding: 0.5rem;
            margin: 0.5rem 0 !important;
        }

        .vehicleCard .card {
            padding: 0.6rem !important;
            margin-bottom: 0.8rem;
        }

        .vehicleCard .row.align-items-center {
            margin-bottom: 0.5rem !important;
        }

        .fs-1 {
            font-size: 1.5rem !important;
        }

        .vehicleCard h4 {
            font-size: 0.9rem;
            margin-top: 0.3rem;
        }

        .badge {
            font-size: 0.6rem;
            padding: 0.2rem 0.4rem;
        }

        .mb-2.fs-5 {
            font-size: 0.75rem !important;
            line-height: 1.3;
        }

        .mb-2.fs-5 strong {
            font-size: 0.7rem;
        }

        .d-flex.gap-3 {
            flex-direction: column;
            gap: 0.4rem !important;
        }

        .btn {
            font-size: 0.75rem;
            padding: 0.4rem 0.6rem;
        }
    }

    /* Small Mobile Phones */
    @media screen and (max-width: 390px) {
        .vehicle-container {
            padding: 0.2rem;
        }

        .com-header h2 {
            font-size: 1rem;
        }

        .com-header p {
            font-size: 0.7rem;
        }

        /* Statistics cards */
        .row.g-3 .card {
            padding: 0.4rem !important;
        }

        .row.g-3 .card h6 {
            font-size: 0.65rem;
        }

        .row.g-3 .card h3 {
            font-size: 1rem;
        }

        .row.g-3 .card .fs-2 {
            font-size: 1.2rem !important;
        }

        /* Search section */
        .border.rounded.p-3 {
            padding: 0.5rem !important;
        }

        .form-control, .form-select {
            font-size: 0.75rem;
        }

        /* Vehicle cards */
        .vehicleCard .card {
            padding: 0.5rem !important;
        }

        .fs-1 {
            font-size: 1.3rem !important;
        }

        .vehicleCard h4 {
            font-size: 0.8rem;
        }

        .mb-2.fs-5 {
            font-size: 0.7rem !important;
        }

        .btn {
            font-size: 0.7rem;
            padding: 0.3rem 0.5rem;
        }
    }

    /* Extra Small Mobile Phones */
    @media screen and (max-width: 320px) {
        .vehicle-container {
            padding: 0.1rem;
        }

        .com-header h2 {
            font-size: 0.9rem;
        }

        .com-header p {
            font-size: 0.65rem;
        }

        /* Statistics cards */
        .row.g-3 .card {
            padding: 0.3rem !important;
        }

        .row.g-3 .card h6 {
            font-size: 0.6rem;
        }

        .row.g-3 .card h3 {
            font-size: 0.9rem;
        }

        .row.g-3 .card .fs-2 {
            font-size: 1.1rem !important;
        }

        /* Vehicle cards */
        .vehicleCard .card {
            padding: 0.4rem !important;
        }

        .fs-1 {
            font-size: 1.2rem !important;
        }

        .vehicleCard h4 {
            font-size: 0.75rem;
        }

        .mb-2.fs-5 {
            font-size: 0.65rem !important;
        }

        .btn {
            font-size: 0.65rem;
            padding: 0.3rem 0.4rem;
        }
    }

    /* Landscape orientation for mobile devices */
    @media screen and (max-height: 500px) and (orientation: landscape) {
        .vehicle-container {
            padding: 0.3rem;
        }

        .com-header {
            margin-bottom: 0.5rem;
        }

        .mt-4 {
            margin-top: 0.8rem !important;
        }

        .vehicleCard .card {
            padding: 0.5rem !important;
        }

        .row.g-3 .card {
            padding: 0.4rem !important;
        }
    }

    /* High DPI displays */
    @media screen and (-webkit-min-device-pixel-ratio: 2),
           screen and (min-resolution: 192dpi) {
        .card {
            border-width: 0.5px;
        }
        
        .border {
            border-width: 0.5px !important;
        }
    }

    /* Specific device optimizations */
    
    /* iPhone 14 Pro Max, iPhone 13 Pro Max, iPhone 12 Pro Max */
    @media screen and (max-width: 430px) {
        .container {
            max-width: 400px;
        }
    }

    /* iPhone 14, iPhone 13, iPhone 12 */
    @media screen and (max-width: 390px) {
        .container {
            max-width: 360px;
        }
    }

    /* iPhone SE, iPhone 8 */
    @media screen and (max-width: 375px) {
        .container {
            max-width: 345px;
        }
    }

    /* Samsung Galaxy S series, Google Pixel */
    @media screen and (max-width: 360px) {
        .container {
            max-width: 330px;
        }
    }

    /* Print styles */
    @media print {
        .btn {
            display: none;
        }
        
        .vehicle-container {
            padding: 0;
        }
        
        .card {
            border: 1px solid #000 !important;
            box-shadow: none !important;
        }
    }
</style>

<body>
    <div class="vehicle-container">
        <div class="owner-list-container">
            <div class="event-container">
                <div class="com-header d-flex justify-content-between">
                    <div class="left">
                        <h2 class="fw-bold">Vehicle Search</h2>
                        <p class="text-muted">Find vehicle owners for complaints or inquiries</p>
                    </div>
                </div>
            </div>

            <div class="mt-4">
                <div class="row g-3">
                    <!-- Total Vehicles -->
                    <div class="col-md-4 col-sm-12">
                        <div class="card p-3 d-flex justify-content-between align-items-center flex-row">
                            <div>
                                <h6 class="text-muted">Total Vehicles</h6>
                                <h3 class="text-primary fw-bold">
                                    <%= twoWheeler + fourWheeler %>
                                </h3>
                            </div>
                            <i class="bi bi-car-front text-primary fs-2"></i>
                        </div>
                    </div>

                    <!-- Two Wheelers -->
                    <div class="col-md-4 col-sm-12">
                        <div class="card p-3 d-flex justify-content-between align-items-center flex-row">
                            <div>
                                <h6 class="text-muted">Two Wheelers</h6>
                                <h3 class="text-success fw-bold">
                                    <%= twoWheeler %>
                                </h3>
                            </div>
                            <i class="bi bi-bicycle text-primary fs-2"></i>
                        </div>
                    </div>

                    <!-- Four Wheelers -->
                    <div class="col-md-4 col-sm-12">
                        <div class="card p-3 d-flex justify-content-between align-items-center flex-row">
                            <div>
                                <h6 class="text-muted">Four Wheelers</h6>
                                <h3 class="text-warning fw-bold">
                                    <%= fourWheeler %>
                                </h3>
                            </div>
                            <i class="bi bi-car-front text-primary fs-2"></i>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-4 border rounded p-3 bg-white">
                <div class="row g-3 align-items-center">
                    <!-- Search Box -->
                    <div class="col-md-9 col-sm-12">
                        <div class="input-group">
                            <span class="input-group-text bg-white border-end-0">
                                <i class="bi bi-search text-muted"></i>
                            </span>
                            <input type="text" id="searchInput" class="form-control border-start-0"
                                placeholder="Search by registration number, owner name, or flat...">
                        </div>
                    </div>

                    <!-- Filter Dropdown -->
                    <div class="col-md-3 col-sm-12">
                        <select id="vehicleType" class="form-select border-primary text-dark fw-semibold">
                            <option selected>All Vehicles</option>
                            <option>Two Wheelers</option>
                            <option>Four Wheelers</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="vehicle-info mt-4 border rounded bg-white">
                <div class="info-head m-4">
                    <h5 class="fw-bold">Search Results</h5>
                </div>
                <hr>

                <div class="container mb-3 mt-4">
                    <div class="row g-3">
                        <% allParkingDetails.forEach(pDetail=> { %>
                            <div class="col-12 col-sm-6 col-md-4 vehicleCard"
                                data-four_wheeler="<%= pDetail.four_wheeler ? pDetail.four_wheeler : '' %>"
                                data-two_wheeler="<%= pDetail.two_wheeler ? pDetail.two_wheeler : '' %>"
                                data-owner="<%= (pDetail.first_name + ' ' + pDetail.last_name).toLowerCase() %>"
                                data-flat="<%= (pDetail.block + '-' + pDetail.flat_number).toLowerCase() %>">
                                <div class="card p-3 shadow-sm h-100">
                                    <div class="row align-items-center mb-3">
                                        <div class="col-auto">
                                            <% if (pDetail.four_wheeler) { %>
                                                <i class="bi bi-car-front fs-1 text-primary"></i>
                                                <h4 class="mb-0">
                                                    <%= pDetail.four_wheeler %>
                                                    <span class="badge bg-light text-primary">4-wheeler</span>
                                                </h4>
                                            <% } %>
                                            <% if (pDetail.two_wheeler) { %>
                                                <i class="bi bi-bicycle fs-1 text-success"></i>
                                                <h4 class="mb-0">
                                                    <%= pDetail.two_wheeler %>
                                                    <span class="badge bg-light text-success">2-wheeler</span>
                                                </h4>
                                            <% } %>
                                        </div>
                                    </div>

                                    <div class="mb-2 fs-5">
                                        <strong>Owner :</strong>
                                        <%= pDetail.first_name %> <%= pDetail.last_name %> <br />
                                        <strong>Flat :</strong> Block <%= pDetail.block %> - <%= pDetail.flat_number %> <br />
                                        <strong>Phone :</strong> +91 <%= pDetail.mobile_number %> <br />
                                    </div>

                                    <div class="d-flex flex-column flex-sm-row gap-3 mt-3">
                                        <button class="btn btn-primary w-100 w-sm-auto">Contact Owner</button>
                                        <button class="btn btn-outline-secondary w-100 w-sm-auto">Report Issue</button>
                                    </div>
                                </div>
                            </div>
                        <% }); %>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function filterVehicle() {
            const search = document.getElementById("searchInput").value.toLowerCase();
            const filter = document.getElementById("vehicleType").value;
            const vehicleCards = document.querySelectorAll(".vehicleCard");

            vehicleCards.forEach(card => {
                const car = card.dataset.four_wheeler.toLowerCase();
                const bike = card.dataset.two_wheeler.toLowerCase();
                const owner = card.dataset.owner;
                const flat = card.dataset.flat;

                const matchesSearch =
                    car.includes(search) ||
                    bike.includes(search) ||
                    owner.includes(search) ||
                    flat.includes(search);

                const type = car ? "Four Wheelers" : "Two Wheelers";
                const matchesType = filter === "All Vehicles" || filter === type;

                if (matchesSearch && matchesType) {
                    card.style.display = "block";
                } else {
                    card.style.display = "none";
                }
            });
        }

        document.getElementById("searchInput").addEventListener("input", filterVehicle);
        document.getElementById("vehicleType").addEventListener("change", filterVehicle);
    </script>
</body>
