<%- layout("layouts/boilerplate") %>
<style>
@media (max-width: 576px) {
  /* Container padding and spacing fix */
  .staff-container {
    padding: 0 1rem;
    margin-bottom: 1rem;
  }

  .owner-list-container {
    padding: 0;
    margin-bottom: 1rem;
  }

  .event-container {
    padding: 0;
    margin-bottom: 1rem;
  }

  /* Header section responsive with proper spacing */
  .com-header {
    margin-bottom: 1.5rem;
  }

  .com-header h2 {
    font-size: 1.15rem;
    margin-bottom: 0.5rem;
  }

  .com-header p {
    font-size: 0.9rem;
    margin-bottom: 0;
  }

  /* Search section - side by side like previous pages */
  .mt-4.border.rounded.p-3.bg-white {
    margin-top: 1.5rem !important;
    margin-bottom: 1.5rem !important;
  }

  .mt-4.border.rounded.p-3.bg-white .row {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    gap: 0.5rem;
    margin-left: 0;
    margin-right: 0;
  }

  .mt-4.border.rounded.p-3.bg-white .col-md-9 {
    width: 75%;
    max-width: 75%;
    flex: 0 0 75%;
    padding-left: 0;
    padding-right: 0;
    margin-left: 0;
    margin-right: 0;
    min-width: 0;
    box-sizing: border-box;
  }

  .mt-4.border.rounded.p-3.bg-white .col-md-3 {
    width: 25%;
    max-width: 25%;
    flex: 0 0 25%;
    padding-left: 0;
    padding-right: 0;
    margin-left: 0;
    margin-right: 0;
    min-width: 0;
    box-sizing: border-box;
  }

  .input-group,
  #roleFilter {
    width: 100%;
    min-width: 0;
  }

  /* Container spacing fix */
  .container.mt-4 {
    margin-top: 1.5rem !important;
    padding-left: 1rem;
    padding-right: 1rem;
  }

  /* Staff cards - 2 per row on mobile with proper spacing */
  .container .row.g-4 {
    --bs-gutter-x: 1rem;
    --bs-gutter-y: 1rem;
    margin-left: 0;
    margin-right: 0;
  }

  .staff-card {
    width: 48% !important;
    max-width: 48% !important;
    flex: 0 0 48% !important;
    margin-bottom: 1rem !important;
    padding-left: 0.5rem;
    padding-right: 0.5rem;
  }

  /* If only one card, make it full width */
  .staff-card:only-child {
    width: 100% !important;
    max-width: 100% !important;
    flex: 0 0 100% !important;
  }

  /* Card content adjustments */
  .card {
    font-size: 0.85rem;
    margin-bottom: 0;
  }

  .card-body {
    padding: 1rem 0.75rem;
  }

  .card-title {
    font-size: 1rem;
    margin-bottom: 0.5rem;
  }

  .text-muted {
    font-size: 0.8rem;
    margin-bottom: 0.75rem;
  }

  .card-body p {
    font-size: 0.8rem;
    margin-bottom: 0.5rem;
  }

  .card-body .fs-1 {
    font-size: 2rem;
    margin-bottom: 1rem;
  }
}
</style>

<body>
    <div class="staff-container">
        <div class="owner-list-container">
            <div class="event-container">
                <div class="com-header d-flex justify-content-between">
                    <div class="left">
                        <h2 class="fw-bold">Society Staff</h2>
                        <p class="text-muted">This page was regarding to society staff</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-4 border rounded p-3 bg-white">
        <div class="row g-3 align-items-center">
            <!-- Search Box -->
            <div class="col-md-9 col-sm-12">
                <div class="input-group">
                    <span class="input-group-text bg-white border-end-0">
                        <i class="bi bi-search text-muted"></i>
                    </span>
                    <input type="text" id="searchInput" class="form-control border-start-0"
                        placeholder="Search by employee name or role..." oninput="filterStaff()">
                </div>
            </div>

            <!-- Filter Dropdown -->
            <div class="col-md-3 col-sm-12">
                <select id="roleFilter" class="form-select border-primary text-dark fw-semibold" onchange="filterStaff()">
                    <option value="">All Staff</option>
                    <option value="Security Guard">Security Guard</option>
                    <option value="Plumber">Plumber</option>
                    <option value="Other">Other</option>
                </select>
            </div>
        </div>
    </div>

    <div class="container mt-4">
        <div class="row g-4" id="staffContainer">
            <% staffDetails.forEach(staff => { %>
            <div class="col-12 col-sm-6 col-md-4 col-lg-3 staff-card" 
                 data-name="<%= staff.name.toLowerCase() %>" 
                 data-role="<%= staff.role %>">
                <div class="card shadow-sm h-100">
                    <div class="card-body text-center">
                        <i class="bi bi-person-badge fs-1 text-primary mb-3"></i>
                        <h5 class="card-title mb-1"><%= staff.name %></h5>
                        <p class="text-muted mb-2"><%= staff.role %></p>
                        <p class="mb-1">
                            <i class="bi bi-telephone-fill me-2"></i>
                            <%= staff.contact %>
                        </p>
                        <p class="mb-0">
                            <i class="bi bi-geo-alt-fill me-2"></i>
                            <%= staff.location %>
                        </p>
                    </div>
                </div>
            </div>
            <% }); %>
        </div>
    </div>

    <script>
        function filterStaff() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const roleFilter = document.getElementById('roleFilter').value;
            const staffCards = document.querySelectorAll('.staff-card');

            staffCards.forEach(card => {
                const name = card.dataset.name;
                const role = card.dataset.role;
                const matchesSearch = name.includes(searchTerm) || role.toLowerCase().includes(searchTerm);
                const matchesRole = !roleFilter || role === roleFilter;

                if (matchesSearch && matchesRole) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Initialize the filter on page load
        document.addEventListener('DOMContentLoaded', filterStaff);
    </script>
</body>